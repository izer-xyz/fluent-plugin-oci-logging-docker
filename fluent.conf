<source>
  @type  forward
  @id    input1
  port  24224
</source>

<source>
  @type systemd
  tag systemd
  read_from_head true

  <storage>
    @type local
    path /var/log/fluentd-journald-cursor.json
  </storage>

  <entry>
    field_map {"MESSAGE": "log", "_PID": ["process", "pid"], "_CMDLINE": "process", "_COMM": "cmd"}
    fields_strip_underscores true
    fields_lowercase true
  </entry>
</source>

<filter docker.**>
 type record_transformer
 <record>
    tailed_path ${record["container_name"]}
 </record>
</filter>

<filter docker.json.**>
  @type parser
  key_name log
  reserve_data true
  <parse>
    @type json
  </parse>
</filter>

<match **>
  @type copy
  
  <store>
    @type oci_logging
    log_object_id  "#{ENV['ORACLE_LOG_OBJECT_ID']}"
  </store>

  <store>
    @type stdout
  </store>
</match>
